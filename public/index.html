<!doctype html>
<html>
<head>
   <link rel="icon" type="image/x-icon" href="public/favicon.ico" />
   <title>PMOD Control For ZYBO</title>
   <script src="socket.io/socket.io.js"></script>
   <style>
      .switch {
         position: relative;
         display: inline-block;
         width: 60px;
         height: 34px;
      }
      
      .switch input { 
         opacity: 0;
         width: 0;
         height: 0;
      }
      
      .slider {
         position: absolute;
         cursor: pointer;
         top: 0;
         left: 0;
         right: 0;
         bottom: 0;
         background-color: #ccc;
         -webkit-transition: .4s;
         transition: .4s;
      }
      
      .slider:before {
         position: absolute;
         content: "";
         height: 26px;
         width: 26px;
         left: 4px;
         bottom: 4px;
         background-color: white;
         -webkit-transition: .4s;
         transition: .4s;
      }
      
      input:checked + .slider {
         background-color: #2196F3;
      }
      
      input:focus + .slider {
         box-shadow: 0 0 1px #2196F3;
      }
      
      input:checked + .slider:before {
         -webkit-transform: translateX(26px);
         -ms-transform: translateX(26px);
         transform: translateX(26px);
      }
      
      /* Rounded sliders */
      .slider.round {
         border-radius: 34px;
      }
      
      .slider.round:before {
         border-radius: 50%;
      }

      .mb-5 {
         margin-bottom: 5px;
      }
   </style>
</head>
<body>
   
   <h1>PMOD Control For ZYBO</h1>
   
   <!-- <button id="lightOn">Turn Light On</button>
   <button id="lightOff">Turn Light Off</button>
   <button onclick="console.log('clicked');">Turn Light Off</button>
   <div>
      <label class="switch">
         <input id="zybo" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="zybo">power on the zybo board</label>
   </div> -->

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin1" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin1">control pmod1 : V12</label>
   </div>

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin2" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin2">control pmod2 : W16</label>
   </div>

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin3" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin3">control pmod3 : J15</label>
   </div>

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin4" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin4">control pmod4 : H15</label>
   </div>

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin7" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin7">control pmod7 : V13</label>
   </div>

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin8" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin8">control pmod8 : U17</label>
   </div>

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin9" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin9">control pmod9 : T17</label>
   </div>

   <div class="mb-5">
      <label class="switch">
         <input id="pmod_pin10" type="checkbox" onchange="sendRequest(this);">
         <span class="slider"></span>
      </label>
      <label for="pmod_pin10">control pmod10 : Y17</label>
   </div>

   
   <script>
      
      var socket = io();
      socket.on('data',function(data){
         if (data) {
            var rcv = JSON.parse(data);
            console.log(rcv);
            for (const key in rcv.pmod_data){
                console.log(`${key} -> ${rcv.pmod_data[key]}`);
                if (key=="power") continue;
                setCheckbox(key, rcv.pmod_data[key]);
            }
         }
      });

      function setCheckbox(id, value) {
        var ckbox=document.getElementById(id);
        // console.log(ckbox);
        value ? ckbox.checked=true : ckbox.checked=false;
      }

      function sendRequest(e){
        // console.log(e);
        if (e.checked) {
            socket.emit('toArduino', { "pin":e.id});
        } else {
            socket.emit('toArduino', { "pin":e.id+"_o"});
        }
      }
      // document.getElementById('lightOn').onclick = function() {
      //    socket.emit('lights', { "pin":"pin1", "action":"HIGH" });
      // };
      
      // document.getElementById('lightOff').onclick = function(){               
      //    socket.emit('lights', { "status":"led off" });
      // };
      
    //   document.getElementById('pmod1').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin1"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin1_o"});
    //      }
    //   };

    //   document.getElementById('pmod2').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin2"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin2_o"});
    //      }
    //   };

    //   document.getElementById('pmod3').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin3"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin3_o"});
    //      }
    //   };

    //   document.getElementById('pmod4').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin4"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin4_o"});
    //      }
    //   };

    //   document.getElementById('pmod7').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin7"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin7_o"});
    //      }
    //   };

    //   document.getElementById('pmod8').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin8"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin8_o"});
    //      }
    //   };

    //   document.getElementById('pmod9').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin9"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin9_o"});
    //      }
    //   };

    //   document.getElementById('pmod10').onchange = function(){
    //      if (this.checked) {
    //         socket.emit('toArduino', { "pin":"pmod_pin10"});
    //      } else {
    //         socket.emit('toArduino', { "pin":"pmod_pin10_o"});
    //      }
    //   };
   </script>
   
</body>
</html>